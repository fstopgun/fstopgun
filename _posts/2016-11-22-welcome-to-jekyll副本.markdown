---
layout: post
title:  "卡牌游戏的 deck 多样性收敛问题"
date:   2016-11-24 12:00:01
categories: jekyll update
---
最近全程围观了万智牌世界杯。作为一个几乎完全退休的万智牌牌手，我最初打万智牌的目的是消磨时光。消磨时光是种天赋，而我似乎天赋异禀。当然，我的打牌水平很差，这个就不细讨论了。

在今年的万智牌世界杯上，发现 modern 赛制的套牌多样性现在已经非常差。共鸣（Affinity）、侵染（UG Infect）、红烧（Boros/Naya Burn）和奥扎奇（Bant Eldrazi）是目前公认的 T1 deck。除此之外，出现了大量具有高爆发力或者 OTK 能力的 T2 甚至准 T1 deck。无怪乎大家普遍说：现在的 modern 赛制就是快攻赛制，三回合赢（确定胜势）是一个重要的衡量标准。

不过今天我这篇文章讨论的不是如何打万智牌，或者如何构筑强力 deck 的问题。而是 deck 多样性收敛的讨论。这些讨论以定性分析为主。

## 单卡价值讨论

仅从单卡上考虑，联想到万智牌的设计特点，一张单卡在构筑型赛事中的**可用性/作战价值**同**设计出现概率**联立起来，大概像是一个双曲正切的样子：



可用性/作战价值越强的卡牌，在牌池中的占有率越低（其可用性/作战价值的相对衡量尺度也会发生变化）。这个曲线随着牌池卡张总数的变化，其形态也会发生变化（越来越陡峭）。


附带说一句，可用性/作战价值的相对衡量尺度问题，大概和正态分布是相似的。牌池越大，sigma 越小。


——所以，万智牌世界里，大量的银铁都是论斤当废纸出售的……

## 牌池的规则

因为 deck 的 Size 是相对固定的，Card Duplicate 也受到限制，所以，牌池的大小，毫无疑问是决定 deck 多样性收敛特性的一个重要因素。

此外，考虑到法术力颜色系统的存在，虽然从采样结果的高值到低值次序排列后择优录取，然而第一次择优过后会存在大量的法术力颜色不相容问题，形成全局禁闭区间，之后所有不相容的采样将被滤除。为了方便分析，将所有不同的法术力选择形成的状态空间均一化处理。

当牌池较小时，相当于双曲正切曲线的低频采样，反之就是高频采样。执行低频采样后的最佳组合设计过程，依照其总体的相对**可用性/作战价值**进行截止式划分，其多样性差（远不如高频采样结果）。相反，如果执行高频采样后的最佳组合设计过程，多样性好（多于低频采样结果）。

收敛稳定后得到的 deck 组，彼此之间的**可用性/作战价值**差距，显而易见的是，高频采样的差异较小（源于高频采样+相对**可用性/作战价值**截止式划分带来的低方差），而低频采样的结果，彼此之间差异大。

## 收敛速度

在牌池内容保持不变的情况下，显然牌池小的情况下，其牌张组合状态空间小，deck 多样性收敛速度快；牌池大，则牌张组合状态空间也大，deck 多样性收敛速度慢。这是一种均一化讨论，尽可能忽视个体差异的结果。

我之前没有解释相对**可用性/作战价值**进行截止式划分的规则。这里解释一下：*按照牌张组合状态空间得到的结果，取可用性/作战价值排序中位于前列的某个百分比。*

## 牌池更新策略对结果的影响

仅以万智牌作为研究对象，牌池更新策略有两种主要的模式，以及一种主要调节手段：

永久性赛制：不断扩大的牌池
时效性赛制：定期圈入与圈出可用卡
调节手段：禁限牌列表

两种更新策略的执行结果大体如下：



永久性赛制的可用 deck 数量高于时效性赛制。时间线前期收敛程度，时效性赛制强于永久性赛制。

## 联立分析

### 静态稳态

如果牌池完全静止，那么我们很容易得知：

deck 多样性收敛速度与初期收敛强度（以百分比计）与牌池大小具备直接相关性。
最终收敛结果与高强度单卡的强度方差有关。方差约大，中位数越高，则收敛结果中，多样性越差。

### 长期动态稳态

对于永久性赛制，长期动态稳态就是在收敛曲线上加入若干尖峰（Impulse），会短暂触发一个快速收敛过程。
对于时效性赛制，会出现类锯齿波形：

再考虑到禁限牌列表更新。假设禁限牌都是强度处于最顶尖的单卡，那么：
- **顶尖单卡->out**会短暂地、较大幅度发散 deck 多样性，但是相对收敛速度会较静态稳态地结果更快。
- **顶尖单卡->in**会短暂地、较小幅度扰动（不确定发散还是收敛） deck 多样性。在微观尺度上是发散还是收敛，取决于被解放的单卡即使在牌池中的相对强度。相对收敛速度不会有太大的变化，轻微扰动的级别。

### 采样曲线漂移

单卡相对强度是随着牌池的不断变化，也在不断变化。如果采用相对强度尺标，那么应该是总体尾部膨胀，中央区域乱流的形态。也就是说，频率均匀采样的结果是基于**静态**，动态化的话，采样频率会变的更高，在当前相对强度尺标的低值区域会 overweight，如果仍然采用相对强度尺标模式的话，scale 必然经历至少一次整定。

所以唯一尽可能保证曲线尽量不漂移的方式，就是牌池更新的 differences 局部高度近似于当前牌池的曲线形态。但是在高强度卡区域很难完成高度近似——采样频率不一致，难以保证噪声幅度，也无法人工滤除噪声。而对于占比极小但直接决定收敛极限的高强度单卡而言，噪声幅度可能直接大幅度改变结果。

### 额外奇点

这些额外奇点，形成原因主要是因为：泛用性不好、自身单兵作战强度有限，但是同时又是某些可以直接决定比赛结果的组合中的必备一环。

## 附加章节：Oracle 勘误

## 附加章节：万智牌套牌构筑思路

## 附加章节：万智牌稀有度与牌价




